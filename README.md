# アプリケーション名

## DIABLO2R TRADES

![screencapture-diablo2r-trades-herokuapp-2022-02-02-02_09_52](https://user-images.githubusercontent.com/78831555/152017200-9332ad27-a3b3-455e-acbc-e129a304ca07.png)

# アプリケーション概要

このゲームは[ハックアンドスラッシュ](https://ja.wikipedia.org/wiki/%E3%83%8F%E3%83%83%E3%82%AF%E3%82%A2%E3%83%B3%E3%83%89%E3%82%B9%E3%83%A9%E3%83%83%E3%82%B7%E3%83%A5)
と呼ばれるジャンルの金字塔である、[Diablo2](https://ja.wikipedia.org/wiki/%E3%83%87%E3%82%A3%E3%82%A2%E3%83%96%E3%83%ADII)
のリメイク版となります。
<br>
こちらのサイトではゲーム内のアイテムをユーザー間でトレードするサイトとなります。
<br>
また登録したアイテムのマッチング機能も備えてあります。
<br>

# アプリケーション URL

https://diablo2trade-ffa7d7d5c39d.herokuapp.com/

# テストアカウント

1.　メールアドレス：admin@example.com パスワード：112233 ※管理者
<br> 2.　メールアドレス：other@example.com パスワード：112233

# 利用方法

テストアカウントにてログインをします。
<br>
プロフィールにてマッチングしたトレードの一覧を見ることができます。
<br>
HOME ではトレードの投稿を行うことができます。
<br>
また各トレード、もしくは各ユーザーのプロフィールからチャットを行うことができます。

#開発に至った理由
下記に記載した理由からこのサイトを開発いたしました。

## 1.公式のトレードサイトがない

このゲームは公式のトレードサイトがありません。
<br>
したがって気軽なトレードを行うことが難しい状況です。
<br>
ですが、トレードなしでこのゲームを全て遊び尽くすのは非常に難しくなっております。
<br>
そのため、外部のトレードサイト等を使ってユーザーはトレードをします。

## 2.プラットフォームの格差

PC に関しては、ロビーと呼ばれる機能がありゲーム内でもある程度トレードを行えます。
<br>
しかし他のプラットホームにはこれが存在しません。
<br>
また他のプラットフォームではチャット機能もないため、
<br>
基本的にはフレンド同士での取引となり、ハードルが高くなっています。
<br>
プラットフォーム間ではデータが共有されるため、
<br>
トレードを頻繁にするために、PC 版を追加で買う方も出ています。

## 3.他のトレードサイトではマッチング機能がない

外部のトレードサイトにおいては、**マッチング機能がありません**。
<br>
そのため自身でアイテムを登録し、連絡が来るのを待つか自身で検索する必要があります。

## 4.他のトレードサイトではアイテム名が統一されていない

外部のトレードサイトでは**アイテム名が統一されておりません**。
<br>
人によってはアイテム名を略称で登録したり、名称そのままで登録します。
<br>
そのため検索した時に、アイテムが検索結果から漏れる可能性があり機会損失となっています。

## 5.私自身がこのゲームのユーザーである

私はゲームが好きで様々なゲームをやったことがあります。
<br>
その中でこのゲームはオリジナル版もプレイしており、
<br>
自身の中でも５本の指に入るほど好きなゲームです。
<br>
そのためこのゲームが好きな全てのユーザーの方のため、利便性を向上させたいと思いました。
<br>

# 機能要件

https://docs.google.com/spreadsheets/d/1YcK3gXo5vAq4ZHjFLzmZ_02ZFpp2fs0TeDTAR4RylZ0/edit?usp=sharing

# 機能概要

## トレード投稿機能

![trade](https://user-images.githubusercontent.com/78831555/152089774-9c8cf7ec-b97f-4f96-898e-db7cac30720b.gif)
<br>
基本的に選択だけでトレードの投稿ができるような投稿機能となります。
<br>
またアイテム名を選択する際にはインクリメンタルサーチ機能で入力者の負担を減らしました。
<br>
アイテム名については外部のサイトをスクレイピングし、ゲームの全てのアイテム名を取得しております。

## マッチング機能

![trade-matching](https://user-images.githubusercontent.com/78831555/152090537-a11a9217-dce2-4e31-ad54-39e81056a88f.gif)
<br>
自身が投稿したトレードの中から一致するものを抽出し、表示します。
<br>
条件としては他の投稿において下記の条件に全て合致すると表示されるようになります。
<br> 1.モードが一致
<br> 2.シーズンが一致
<br> 3.自身の欲しいアイテムと他の投稿の提示アイテムが一致
<br> 4.自身の提示アイテムと他の投稿の欲しいアイテムが一致
<br> 5.自身のプラットフォームと他の投稿のユーザーのプラットフォームがどれか一致
<br>

以上の条件となります。
<br>
上記の GIF の場合、最下部の投稿が自身の投稿となります。
<br>
そして真ん中の投稿が条件と全て一致しているため、マッチングしたトレードとして表示されます。
<br>
最上部の投稿に関しては、プラットフォームのみ異なるためマッチングからは除外されます。
<br>

## プラットフォーム変更の際の過去の投稿への自動反映

![platform](https://user-images.githubusercontent.com/78831555/152092142-18bbdaa5-f40b-48d1-af4d-b557d3651c6f.gif)
<br>
プラットフォームを変更した際に過去の投稿へも自動反映されます。
<br>
またマッチング機能においてもこれが適用されます。
<br>
上記 GIF の場合、プラットフォームを変えたことにより最上部の投稿と一致し、マッチングします。
<br>
真ん中の投稿に関しては、プラットフォームが一致しないため今度はマッチングから除外されます。
<br>

## チャット機能

![chat](https://user-images.githubusercontent.com/78831555/152092579-795f4a91-2dc3-4721-99c8-caf9931e1014.gif)
<br>
各トレードの投稿もしくは Users から各ユーザーとチャットができます。
<br>
また送ったメッセージを削除することもできます。
<br>
投稿者に関しては、非同期でのメッセージの表示、削除ができます。

# データベース ER 図

https://drive.google.com/file/d/1DKXfljrputqs5b3cfl9H_m5LtDbiBOqI/view?usp=sharing

# 工夫した点

## 1. アイテム名の統一

アイテム名をデータから選択するようにし、略称等での登録にならないようにしました。
<br>
またアイテム名はかなり沢山あるため、検索機能を付けてユーザーの負担を減らしました。

## 2. 精巧なマッチング機能

本来はアイテム名のみのマッチング機能を考えておりました。
<br>
しかしそれだと自身と関係ないトレードも表示されてしまうため
<br>
条件を増やし、精巧なマッチング結果を出せるようにしました。
<br>
マッチング結果に出たトレードはすぐにトレードができるものとなります。
<br>

## 3. プラットフォームの動的変更

今のデータベースの設計になる前はプラットフォームをトレードと結びつけ、
<br>
中間テーブルを作成し、取得するようにしておりました。
<br>
しかし、その場合間違って異なるプラットフォームを選択した際に、
<br>
そのプラットフォームもマッチング結果に反映されてしまいます。
<br>
また過去の投稿においてはプラットフォームが変わっても動的に変更されないため
<br>
精巧なマッチングをすることが出来ない状態でした。
<br>
<br>
しかし、プラットフォームは本来投稿ごとに変わるものではありません。
<br>
基本的にはプラットフォームは不変のものであり、
<br>
**本来はユーザーと結びつくものだと気づきました。**
<br>
そこで今のデータベースの設計となりました。
<br>
その結果として、精巧なマッチング機能と過去の投稿への自動反映の両方を満たすことが出来ました。

# 使用技術

## フロントエンド

HTML
<br>
CSS
<br>
Ruby 2.6.9
<br>
Ruby on Rails 6.0.3
<br>
Bootstrap 4.5
<br>
Jquery
<br>

## バックエンド

Ruby 2.6.9
<br>
Ruby on Rails 6.0.3

## インフラ

Heroku
